<div class="virtual-table-test">
  <div class="increator">
    <mat-form-field>
      <mat-label>Rows</mat-label>
      <input matInput type="number" [(ngModel)]="rowCount" (ngModelChange)="rowChange($event)">
    </mat-form-field>
    <mat-form-field>
      <mat-label>Columns</mat-label>
      <input matInput type="number" [(ngModel)]="columnCount" (ngModelChange)="columnsChange($event)">
    </mat-form-field>
  </div>
  <cdk-virtual-scroll-viewport class="data-grid-table-wrapper" [tvsItemSize]="50" [headerHeight]="56"
    [bufferMultiplier]="1" [ngStyle]="{'height.px': 500, 'width': '100%'}">
    <table mat-table [dataSource]="tableRows">
      <ng-container matColumnDef="{{column}}" *ngFor="let column of columnNames; let i = index;"
        sticky="{{i < 2}}">
        <th mat-header-cell *matHeaderCellDef>
          <span>{{column}}</span>
        </th>
        <td mat-cell *matCellDef="let row" [ngClass]="row[column].cellClass">

          <ng-template let-cellValue
            [ngTemplateOutletContext]="{
              $implicit: row[column].value
            }"
            [ngTemplateOutlet]="self" #self>
            <div
              [ngClass]="{ 'small-font': cellValueTpl.scrollWidth < 150 }"
              [tooltip]="cellValueTpl.scrollWidth < 150 ? cellValueTooltip : undefined">
              <div #cellValueTpl>{{ cellValue }}</div>
            </div>
            <ng-template #cellValueTooltip>
              This cell value is {{cellValue}}!
            </ng-template>
          </ng-template>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="columnNames, sticky: true"></tr>
      <tr mat-row *matRowDef="let row; columns: columnNames;" [ngStyle]="{'height.px': 50}"></tr>
    </table>
  </cdk-virtual-scroll-viewport>
</div>
